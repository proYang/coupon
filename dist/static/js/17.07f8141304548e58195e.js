webpackJsonp([17],{1022:function(e,t,a){var o=a(960);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(494)("37ae33c2",o,!0)},1053:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=window;t.default={data:function(){return{pickerOtherOption:{editable:!1,clearable:!1},searchParams:{search:"",size:10,page:1},selected:[],couponHistory:[],Form:{couponOptions:[],selected:[],desc:"",name:""},useTimes:[(new Date).getTime(),(new Date).getTime()+2592e6],receiveTimes:[(new Date).getTime(),(new Date).getTime()+3456e6]}},methods:{pickTime:function(){console.log(this.useTimes),console.log(this.receiveTimes)},changeContent:function(e){var t=this;t.selected=[],e.forEach(function(e){t.couponHistory.forEach(function(a){e==a.value&&t.selected.push(a)})})},searchList:function(e){var t=this,a=this.searchParams;e&&e.length>0?a.search=e:a.search="",t.$api.getAllCoupon(a).then(function(e){t.Form.couponOptions=[],e.data.forEach(function(e){t.couponHistory.some(function(t){return t.value==e.id})||t.couponHistory.push({value:e.id,label:e.display_name}),t.Form.couponOptions.push({value:e.id,label:e.display_name})})})},submitForm:function(e){var t=this,a=JSON.parse(o.localStorage.getItem("shop_info")),n=this.selected,i=this.useTimes,r=this.receiveTimes,s=[];n.forEach(function(e){e.value&&s.push({coupon_id:e.value,num:e.num,receive_start:r[0],receive_end:r[1],use_start:i[0],use_end:i[1]})});var l={shop_id:a.id,name:t.Form.name,description:t.Form.desc,coupons:s};t.$api.distributeCoupon(l).then(function(e){if(200!=e.state)return void t.$alert("系统错误，请重试","提示",{confirmButtonText:"我知道了"});t.$alert("投放成功","提示",{confirmButtonText:"我知道了"}),t.$router.replace({path:"/throwCoupon"})})}},mounted:function(){var e=this;this.searchList(""),this.$store.getters.couponInfo.coupons.forEach(function(t){e.selected.push({num:t.num,label:t.name})})},destroyed:function(){this.$store.dispatch("setCouponInfo",[])}}},513:function(e,t,a){a(1022);var o=a(187)(a(1053),a(999),"data-v-8ce5b7a4",null);e.exports=o.exports},960:function(e,t,a){t=e.exports=a(493)(),t.push([e.i,".demo-dynamic[data-v-8ce5b7a4]{margin-top:40px}.coupons[data-v-8ce5b7a4]{width:500px}.numbers[data-v-8ce5b7a4]{width:250px}.plan-name[data-v-8ce5b7a4]{width:350px}.textarea[data-v-8ce5b7a4]{width:600px}",""])},999:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("投放面板")]),e._v(" "),a("el-form",{ref:"ruleForm",staticClass:"demo-dynamic",attrs:{model:e.Form,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"选择优惠券"}},[a("el-select",{staticClass:"coupons",attrs:{filterable:"","filter-method":e.searchList,multiple:"",placeholder:"请输入优惠券名称，搜索需要投放的优惠券"},on:{change:e.changeContent},model:{value:e.Form.selected,callback:function(t){e.Form.selected=t},expression:"Form.selected"}},e._l(e.Form.couponOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"投放方案名称",prop:"name"}},[a("el-input",{staticClass:"plan-name",attrs:{placeholder:"请填入要投放方案名称"},model:{value:e.Form.name,callback:function(t){e.Form.name=t},expression:"Form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"领取时间范围",clearable:e.pickerOtherOption.clearable,editable:e.pickerOtherOption.editable,required:""}},[a("el-date-picker",{attrs:{type:"daterange",placeholder:"选择领取时间范围",align:"left"},on:{change:e.pickTime},model:{value:e.useTimes,callback:function(t){e.useTimes=t},expression:"useTimes"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"使用时间范围",clearable:e.pickerOtherOption.clearable,editable:e.pickerOtherOption.editable,required:""}},[a("el-date-picker",{attrs:{type:"daterange",placeholder:"选择使用时间范围",align:"left"},on:{change:e.pickTime},model:{value:e.receiveTimes,callback:function(t){e.receiveTimes=t},expression:"receiveTimes"}})],1),e._v(" "),e._l(e.selected,function(e,t){return a("el-form-item",{key:e.value,attrs:{label:e.label}},[a("el-input",{staticClass:"numbers",attrs:{placeholder:"填入要投放的数量（张）",required:""},model:{value:e.num,callback:function(t){e.num=t},expression:"item.num"}})],1)}),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"desc"}},[a("el-input",{staticClass:"textarea",attrs:{type:"textarea",placeholder:"请填写投放备注"},model:{value:e.Form.desc,callback:function(t){e.Form.desc=t},expression:"Form.desc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("投放")])],1)],2)],1)},staticRenderFns:[]}}});